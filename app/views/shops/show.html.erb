<main class="posts-index">
  <%= render 'shared/header' %>
  <section class="index-main-contents">
    <%# お店名 %>
    <section class="main-left">
      <h1 class="item-review-title"><%= @shop.name %></h1>
      <div class="item-review-top-icon">
        <div class="item-review-bottom" data-score="<%= @average_review %>"></div>
        <p>(<%= @review.count %>)</p>
      </div>

      <%# お店詳細情報 %>
      <div class="item-detail">
        <%= image_tag @shop.images[0], class: "item-detail-image" %>
        <div class="item-datail-main">
          <p><%= @shop.explanation %></p>
        </div>
      </div>
      <div class="item-button-lists">
        <%= link_to "お店情報編集", edit_shop_path(@shop), class: "item-edit-buttton" %>
        <%= link_to "お店情報削除", shop_path(@shop), class: "item-edit-buttton", method: :delete %>
      </div>
      <div class="review-add-button">
        <%= link_to "レビュー投稿", new_shop_shop_review_path(@shop), class: "item-edit-buttton" %>
      </div>


      <%# レビュー一覧 %>
      <ul class="item-reviews">
        <% @review.each do |review| %>
          <li class="item-review">
            <div class="item-review-top">
              <%= link_to image_tag(review.account.images[0], class: "item-review-icon"), home_path(review.account.id) if review.account.images.attached?%>
              <% if review.account.images.length == 0%>
                <%= link_to image_tag('profile-user.png', class: "item-review-icon"), home_path(review.account.id) %>
              <% end %>
              <div class="item-review-info">
                <div class="item-reviwer-name"><%= review.account.nickname %></div>
                <div class="item-review-bottom" data-score="<%= review.rate %>"></div>
              </div>
            </div>
            <div class="item-review-conrtent">
              <p><%= review.comment %></p>
            </div>
            <div class="item-review-data">
              <p><%= review.updated_at.to_s(:datetime) %></p>
            </div>
          </li>
        <% end %>
      </ul>
      <script>
        $('.item-review-bottom').raty({
            readOnly: true,
            score: function() {
              return $(this).attr('data-score');
            },
            path: '/assets/'
        });
      </script>
    </section>

    <%# ユーザー情報 %>
  <%= render partial: 'shared/userpro', locals: { pet: @pet } %>
  </section>
  <%= render 'shared/footer' %>
</main>